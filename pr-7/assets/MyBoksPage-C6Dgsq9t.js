import{h as ie,b as n,g as ce,a as de,D as ue,u as pe,f as V,c as z,l as E,Q as F,d as he,s as L,e as we,R as $t,U as Gt,m as st,_ as at,V as Ie,W as it,B as ct,X as Ce,Y as Ht,Z as dt,$ as ut,a0 as pt,a1 as Te,j as Vt,a2 as Ae,a3 as oe,a4 as Xt,O as Yt,a5 as Kt,a6 as qt,i as Le,q as Me,t as U,a7 as jt,T as k,I as Qt,H as Zt,F as Jt,o as A,a8 as ye,a9 as eo,aa as Fe,ab as to,ac as oo,n as Z,ad as no,ae as ro,af as lo,ag as te,ah as so,ai as H,aj as ao,ak as Be,al as io,am as co,an as ht,ao as ft,ap as bt,aq as uo,ar as po,as as ho,C as fo,at as ve,au as bo,k as mo,v as go}from"./index-DidlT2Im.js";import{I as et,V as tt,a as ot,A as vo}from"./VisibilityOff-Ca8ld9R7.js";import{D as So}from"./Delete-iTOJBPk3.js";const yo=ie(n("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function Io(t){return ce("MuiAvatar",t)}de("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Co=t=>{const{classes:e,variant:o,colorDefault:r}=t;return he({root:["root",o,r&&"colorDefault"],img:["img"],fallback:["fallback"]},Io,e)},To=L("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.root,e[o.variant],o.colorDefault&&e.colorDefault]}})(we(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),wo=L("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),xo=L(yo,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function _o({crossOrigin:t,referrerPolicy:e,src:o,srcSet:r}){const[c,s]=E(!1);return F(()=>{if(!o&&!r)return;s(!1);let u=!0;const p=new Image;return p.onload=()=>{u&&s("loaded")},p.onerror=()=>{u&&s("error")},p.crossOrigin=t,p.referrerPolicy=e,p.src=o,r&&(p.srcset=r),()=>{u=!1}},[t,e,o,r]),c}const Ro=ue(function(e,o){const r=pe({props:e,name:"MuiAvatar"}),{alt:c,children:s,className:u,component:p="div",slots:i={},slotProps:g={},imgProps:m,sizes:I,src:y,srcSet:C,variant:_="circular",...h}=r;let f=null;const a={...r,component:p,variant:_},T=_o({...m,...typeof g.img=="function"?g.img(a):g.img,src:y,srcSet:C}),B=y||C,b=B&&T!=="error";a.colorDefault=!b,delete a.ownerState;const R=Co(a),[W,K]=V("root",{ref:o,className:z(R.root,u),elementType:To,externalForwardedProps:{slots:i,slotProps:g,component:p,...h},ownerState:a}),[J,X]=V("img",{className:R.img,elementType:wo,externalForwardedProps:{slots:i,slotProps:{img:{...m,...g.img}}},additionalProps:{alt:c,src:y,srcSet:C,sizes:I},ownerState:a}),[P,ne]=V("fallback",{className:R.fallback,elementType:xo,externalForwardedProps:{slots:i,slotProps:g},shouldForwardComponentProp:!0,ownerState:a});return b?f=n(J,{...X}):s||s===0?f=s:B&&c?f=c[0]:f=n(P,{...ne}),n(W,{...K,children:f})});function Eo(t){return ce("MuiListItemAvatar",t)}de("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Ao=t=>{const{alignItems:e,classes:o}=t;return he({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Eo,o)},Bo=L("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.root,o.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),ko=ue(function(e,o){const r=pe({props:e,name:"MuiListItemAvatar"}),{className:c,...s}=r,u=$t(Gt),p={...r,alignItems:u.alignItems},i=Ao(p);return n(Bo,{className:z(i.root,c),ownerState:p,ref:o,...s})});function No(t){return ce("MuiTab",t)}const N=de("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),Po=t=>{const{classes:e,textColor:o,fullWidth:r,wrapped:c,icon:s,label:u,selected:p,disabled:i}=t,g={root:["root",s&&u&&"labelIcon",`textColor${it(o)}`,r&&"fullWidth",c&&"wrapped",p&&"selected",i&&"disabled"],icon:["iconWrapper","icon"]};return he(g,No,e)},Do=L(ct,{name:"MuiTab",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.root,o.label&&o.icon&&e.labelIcon,e[`textColor${it(o.textColor)}`],o.fullWidth&&e.fullWidth,o.wrapped&&e.wrapped,{[`& .${N.iconWrapper}`]:e.iconWrapper},{[`& .${N.icon}`]:e.icon}]}})(we(({theme:t})=>({...t.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:e})=>e.label&&(e.iconPosition==="top"||e.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:e})=>e.label&&e.iconPosition!=="top"&&e.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:e})=>e.icon&&e.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:e,iconPosition:o})=>e.icon&&e.label&&o==="top",style:{[`& > .${N.icon}`]:{marginBottom:6}}},{props:({ownerState:e,iconPosition:o})=>e.icon&&e.label&&o==="bottom",style:{[`& > .${N.icon}`]:{marginTop:6}}},{props:({ownerState:e,iconPosition:o})=>e.icon&&e.label&&o==="start",style:{[`& > .${N.icon}`]:{marginRight:t.spacing(1)}}},{props:({ownerState:e,iconPosition:o})=>e.icon&&e.label&&o==="end",style:{[`& > .${N.icon}`]:{marginLeft:t.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${N.selected}`]:{opacity:1},[`&.${N.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${N.selected}`]:{color:(t.vars||t).palette.primary.main},[`&.${N.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${N.selected}`]:{color:(t.vars||t).palette.secondary.main},[`&.${N.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:({ownerState:e})=>e.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:e})=>e.wrapped,style:{fontSize:t.typography.pxToRem(12)}}]}))),ke=ue(function(e,o){const r=pe({props:e,name:"MuiTab"}),{className:c,disabled:s=!1,disableFocusRipple:u=!1,fullWidth:p,icon:i,iconPosition:g="top",indicator:m,label:I,onChange:y,onClick:C,onFocus:_,selected:h,selectionFollowsFocus:f,textColor:a="inherit",value:T,wrapped:B=!1,...b}=r,R={...r,disabled:s,disableFocusRipple:u,selected:h,icon:!!i,iconPosition:g,label:!!I,fullWidth:p,textColor:a,wrapped:B},W=Po(R),K=i&&I&&st(i)?at(i,{className:z(W.icon,i.props.className)}):i,J=P=>{!h&&y&&y(P,T),C&&C(P)},X=P=>{f&&!h&&y&&y(P,T),_&&_(P)};return n(Do,{focusRipple:!u,className:z(W.root,c),ref:o,role:"tab","aria-selected":h,disabled:s,onClick:J,onFocus:X,ownerState:R,tabIndex:h?0:-1,...b,children:[g==="top"||g==="start"?n(Ie,{children:[K,I]}):n(Ie,{children:[I,K]}),m]})}),Fo=ie(n("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),Lo=ie(n("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}));function Mo(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2}function Oo(t,e,o,r={},c=()=>{}){const{ease:s=Mo,duration:u=300}=r;let p=null;const i=e[t];let g=!1;const m=()=>{g=!0},I=y=>{if(g){c(new Error("Animation cancelled"));return}p===null&&(p=y);const C=Math.min(1,(y-p)/u);if(e[t]=s(C)*(o-i)+i,C>=1){requestAnimationFrame(()=>{c(null)});return}requestAnimationFrame(I)};return i===o?(c(new Error("Element already at target position")),m):(requestAnimationFrame(I),m)}const zo={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function Uo(t){const{onChange:e,...o}=t,r=Ce(),c=Ce(null),s=()=>{r.current=c.current.offsetHeight-c.current.clientHeight};return Ht(()=>{const u=dt(()=>{const i=r.current;s(),i!==r.current&&e(r.current)}),p=ut(c.current);return p.addEventListener("resize",u),()=>{u.clear(),p.removeEventListener("resize",u)}},[e]),F(()=>{s(),e(r.current)},[e]),n("div",{style:zo,...o,ref:c})}function Wo(t){return ce("MuiTabScrollButton",t)}const $o=de("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),Go=t=>{const{classes:e,orientation:o,disabled:r}=t;return he({root:["root",o,r&&"disabled"]},Wo,e)},Ho=L(ct,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.root,o.orientation&&e[o.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${$o.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),Vo=ue(function(e,o){const r=pe({props:e,name:"MuiTabScrollButton"}),{className:c,slots:s={},slotProps:u={},direction:p,orientation:i,disabled:g,...m}=r,I=pt(),y={isRtl:I,...r},C=Go(y),_=s.StartScrollButtonIcon??Fo,h=s.EndScrollButtonIcon??Lo,f=Te({elementType:_,externalSlotProps:u.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:y}),a=Te({elementType:h,externalSlotProps:u.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:y});return n(Ho,{component:"div",className:z(C.root,c),ref:o,role:null,ownerState:y,tabIndex:null,...m,style:{...m.style,...i==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${I?-90:90}deg)`}},children:p==="left"?n(_,{...f}):n(h,{...a})})});function Xo(t){return ce("MuiTabs",t)}const Ne=de("MuiTabs",["root","vertical","list","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),nt=(t,e)=>t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:t.firstChild,rt=(t,e)=>t===e?t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:t.lastChild,Se=(t,e,o)=>{let r=!1,c=o(t,e);for(;c;){if(c===t.firstChild){if(r)return;r=!0}const s=c.disabled||c.getAttribute("aria-disabled")==="true";if(!c.hasAttribute("tabindex")||s)c=o(t,c);else{c.focus();return}}},Yo=t=>{const{vertical:e,fixed:o,hideScrollbar:r,scrollableX:c,scrollableY:s,centered:u,scrollButtonsHideMobile:p,classes:i}=t;return he({root:["root",e&&"vertical"],scroller:["scroller",o&&"fixed",r&&"hideScrollbar",c&&"scrollableX",s&&"scrollableY"],list:["list","flexContainer",e&&"flexContainerVertical",e&&"vertical",u&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",p&&"scrollButtonsHideMobile"],scrollableX:[c&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},Xo,i)},Ko=L("div",{name:"MuiTabs",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[{[`& .${Ne.scrollButtons}`]:e.scrollButtons},{[`& .${Ne.scrollButtons}`]:o.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,o.vertical&&e.vertical]}})(we(({theme:t})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.scrollButtonsHideMobile,style:{[`& .${Ne.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}}}]}))),qo=L("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.scroller,o.fixed&&e.fixed,o.hideScrollbar&&e.hideScrollbar,o.scrollableX&&e.scrollableX,o.scrollableY&&e.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:t})=>t.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:t})=>t.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:t})=>t.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:t})=>t.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),jo=L("div",{name:"MuiTabs",slot:"List",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.list,e.flexContainer,o.vertical&&e.flexContainerVertical,o.centered&&e.centered]}})({display:"flex",variants:[{props:({ownerState:t})=>t.vertical,style:{flexDirection:"column"}},{props:({ownerState:t})=>t.centered,style:{justifyContent:"center"}}]}),Qo=L("span",{name:"MuiTabs",slot:"Indicator"})(we(({theme:t})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(t.vars||t).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(t.vars||t).palette.secondary.main}},{props:({ownerState:e})=>e.vertical,style:{height:"100%",width:2,right:0}}]}))),Zo=L(Uo)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),lt={},Jo=ue(function(e,o){const r=pe({props:e,name:"MuiTabs"}),c=Vt(),s=pt(),{"aria-label":u,"aria-labelledby":p,action:i,centered:g=!1,children:m,className:I,component:y="div",allowScrollButtonsMobile:C=!1,indicatorColor:_="primary",onChange:h,orientation:f="horizontal",ScrollButtonComponent:a,scrollButtons:T="auto",selectionFollowsFocus:B,slots:b={},slotProps:R={},TabIndicatorProps:W={},TabScrollButtonProps:K={},textColor:J="primary",value:X,variant:P="standard",visibleScrollbar:ne=!1,...vt}=r,M=P==="scrollable",D=f==="vertical",re=D?"scrollTop":"scrollLeft",fe=D?"top":"left",be=D?"bottom":"right",xe=D?"clientHeight":"clientWidth",le=D?"height":"width",$={...r,component:y,allowScrollButtonsMobile:C,indicatorColor:_,orientation:f,vertical:D,scrollButtons:T,textColor:J,variant:P,visibleScrollbar:ne,fixed:!M,hideScrollbar:M&&!ne,scrollableX:M&&!D,scrollableY:M&&D,centered:g&&!M,scrollButtonsHideMobile:!C},Y=Yo($),St=Te({elementType:b.StartScrollButtonIcon,externalSlotProps:R.startScrollButtonIcon,ownerState:$}),yt=Te({elementType:b.EndScrollButtonIcon,externalSlotProps:R.endScrollButtonIcon,ownerState:$}),[Oe,It]=E(!1),[q,ze]=E(lt),[Ue,Ct]=E(!1),[We,Tt]=E(!1),[$e,wt]=E(!1),[Ge,xt]=E({overflow:"hidden",scrollbarWidth:0}),He=new Map,G=Ce(null),j=Ce(null),ee={slots:b,slotProps:{indicator:W,scrollButtons:K,...R}},Ve=()=>{const l=G.current;let d;if(l){const v=l.getBoundingClientRect();d={clientWidth:l.clientWidth,scrollLeft:l.scrollLeft,scrollTop:l.scrollTop,scrollWidth:l.scrollWidth,top:v.top,bottom:v.bottom,left:v.left,right:v.right}}let S;if(l&&X!==!1){const v=j.current.children;if(v.length>0){const x=v[He.get(X)];S=x?x.getBoundingClientRect():null}}return{tabsMeta:d,tabMeta:S}},se=Ae(()=>{const{tabsMeta:l,tabMeta:d}=Ve();let S=0,v;D?(v="top",d&&l&&(S=d.top-l.top+l.scrollTop)):(v=s?"right":"left",d&&l&&(S=(s?-1:1)*(d[v]-l[v]+l.scrollLeft)));const x={[v]:S,[le]:d?d[le]:0};if(typeof q[v]!="number"||typeof q[le]!="number")ze(x);else{const O=Math.abs(q[v]-x[v]),Q=Math.abs(q[le]-x[le]);(O>=1||Q>=1)&&ze(x)}}),_e=(l,{animation:d=!0}={})=>{d?Oo(re,G.current,l,{duration:c.transitions.duration.standard}):G.current[re]=l},Xe=l=>{let d=G.current[re];D?d+=l:d+=l*(s?-1:1),_e(d)},Ye=()=>{const l=G.current[xe];let d=0;const S=Array.from(j.current.children);for(let v=0;v<S.length;v+=1){const x=S[v];if(d+x[xe]>l){v===0&&(d=l);break}d+=x[xe]}return d},_t=()=>{Xe(-1*Ye())},Rt=()=>{Xe(Ye())},[Et,{onChange:Ke,...At}]=V("scrollbar",{className:z(Y.scrollableX,Y.hideScrollbar),elementType:Zo,shouldForwardComponentProp:!0,externalForwardedProps:ee,ownerState:$}),Bt=oe(l=>{Ke?.(l),xt({overflow:null,scrollbarWidth:l})},[Ke]),[qe,je]=V("scrollButtons",{className:z(Y.scrollButtons,K.className),elementType:Vo,externalForwardedProps:ee,ownerState:$,additionalProps:{orientation:f,slots:{StartScrollButtonIcon:b.startScrollButtonIcon||b.StartScrollButtonIcon,EndScrollButtonIcon:b.endScrollButtonIcon||b.EndScrollButtonIcon},slotProps:{startScrollButtonIcon:St,endScrollButtonIcon:yt}}}),kt=()=>{const l={};l.scrollbarSizeListener=M?n(Et,{...At,onChange:Bt}):null;const S=M&&(T==="auto"&&(Ue||We)||T===!0);return l.scrollButtonStart=S?n(qe,{direction:s?"right":"left",onClick:_t,disabled:!Ue,...je}):null,l.scrollButtonEnd=S?n(qe,{direction:s?"left":"right",onClick:Rt,disabled:!We,...je}):null,l},Qe=Ae(l=>{const{tabsMeta:d,tabMeta:S}=Ve();if(!(!S||!d)){if(S[fe]<d[fe]){const v=d[re]+(S[fe]-d[fe]);_e(v,{animation:l})}else if(S[be]>d[be]){const v=d[re]+(S[be]-d[be]);_e(v,{animation:l})}}}),me=Ae(()=>{M&&T!==!1&&wt(!$e)});F(()=>{const l=dt(()=>{G.current&&se()});let d;const S=O=>{O.forEach(Q=>{Q.removedNodes.forEach(ae=>{d?.unobserve(ae)}),Q.addedNodes.forEach(ae=>{d?.observe(ae)})}),l(),me()},v=ut(G.current);v.addEventListener("resize",l);let x;return typeof ResizeObserver<"u"&&(d=new ResizeObserver(l),Array.from(j.current.children).forEach(O=>{d.observe(O)})),typeof MutationObserver<"u"&&(x=new MutationObserver(S),x.observe(j.current,{childList:!0})),()=>{l.clear(),v.removeEventListener("resize",l),x?.disconnect(),d?.disconnect()}},[se,me]),F(()=>{const l=Array.from(j.current.children),d=l.length;if(typeof IntersectionObserver<"u"&&d>0&&M&&T!==!1){const S=l[0],v=l[d-1],x={root:G.current,threshold:.99},O=Ee=>{Ct(!Ee[0].isIntersecting)},Q=new IntersectionObserver(O,x);Q.observe(S);const ae=Ee=>{Tt(!Ee[0].isIntersecting)},Je=new IntersectionObserver(ae,x);return Je.observe(v),()=>{Q.disconnect(),Je.disconnect()}}},[M,T,$e,m?.length]),F(()=>{It(!0)},[]),F(()=>{se()}),F(()=>{Qe(lt!==q)},[Qe,q]),Xt(i,()=>({updateIndicator:se,updateScrollButtons:me}),[se,me]);const[Nt,Pt]=V("indicator",{className:z(Y.indicator,W.className),elementType:Qo,externalForwardedProps:ee,ownerState:$,additionalProps:{style:q}}),Ze=n(Nt,{...Pt});let ge=0;const Dt=Yt.map(m,l=>{if(!st(l))return null;const d=l.props.value===void 0?ge:l.props.value;He.set(d,ge);const S=d===X;return ge+=1,at(l,{fullWidth:P==="fullWidth",indicator:S&&!Oe&&Ze,selected:S,selectionFollowsFocus:B,onChange:h,textColor:J,value:d,...ge===1&&X===!1&&!l.props.tabIndex?{tabIndex:0}:{}})}),Ft=l=>{if(l.altKey||l.shiftKey||l.ctrlKey||l.metaKey)return;const d=j.current,S=Kt(qt(d));if(S?.getAttribute("role")!=="tab")return;let x=f==="horizontal"?"ArrowLeft":"ArrowUp",O=f==="horizontal"?"ArrowRight":"ArrowDown";switch(f==="horizontal"&&s&&(x="ArrowRight",O="ArrowLeft"),l.key){case x:l.preventDefault(),Se(d,S,rt);break;case O:l.preventDefault(),Se(d,S,nt);break;case"Home":l.preventDefault(),Se(d,null,nt);break;case"End":l.preventDefault(),Se(d,null,rt);break}},Re=kt(),[Lt,Mt]=V("root",{ref:o,className:z(Y.root,I),elementType:Ko,externalForwardedProps:{...ee,...vt,component:y},ownerState:$}),[Ot,zt]=V("scroller",{ref:G,className:Y.scroller,elementType:qo,externalForwardedProps:ee,ownerState:$,additionalProps:{style:{overflow:Ge.overflow,[D?`margin${s?"Left":"Right"}`:"marginBottom"]:ne?void 0:-Ge.scrollbarWidth}}}),[Ut,Wt]=V("list",{ref:j,className:z(Y.list,Y.flexContainer),elementType:jo,externalForwardedProps:ee,ownerState:$,getSlotProps:l=>({...l,onKeyDown:d=>{Ft(d),l.onKeyDown?.(d)}})});return n(Lt,{...Mt,children:[Re.scrollButtonStart,Re.scrollbarSizeListener,n(Ot,{...zt,children:[n(Ut,{"aria-label":u,"aria-labelledby":p,"aria-orientation":f==="vertical"?"vertical":null,role:"tablist",...Wt,children:Dt}),Oe&&Ze]}),Re.scrollButtonEnd]})}),en=ie(n("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),tn=ie(n("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 18H4V4h16zM18 6h-5c-1.1 0-2 .9-2 2v2.28c-.6.35-1 .98-1 1.72 0 1.1.9 2 2 2s2-.9 2-2c0-.74-.4-1.38-1-1.72V8h3v8H8V8h2V6H6v12h12z"})),mt=(t,e)=>{if(!t||!e)return 0;const o=t.replace(/[^0-9.]/g,""),r=e.replace(/[^0-9.]/g,""),c=o.split(".").map(Number),s=r.split(".").map(Number);for(let u=0;u<Math.max(c.length,s.length);u++){const p=c[u]||0,i=s[u]||0;if(p>i)return 1;if(p<i)return-1}return 0},on=({deviceId:t})=>{const{t:e}=Le(["common","settings"]),{activeDevice:o,updateDeviceDetails:r,removeDevice:c,toggleLaPoste:s}=Me(),[u,p]=U(E({key:!o?.configuration_key,pin:!o?.door_pin_code}),"visibleFields"),[i,g]=U(E(o?.friendly_name||""),"deviceName"),[m,I]=U(E(o?.configuration_key||""),"configurationKey"),[y,C]=U(E(o?.door_pin_code||""),"doorPinCode");jt.useEffect(()=>{o&&(g(o.friendly_name||""),I(o.configuration_key||""),C(o.door_pin_code||""))},[o]);const _=b=>{p(R=>({...R,[b]:!R[b]}))},h=async()=>{if(o)try{await r(t,{friendly_name:i,configuration_key:m,door_pin_code:y})}catch(b){console.error("Failed to update device details:",b)}},f=async b=>{try{await s(b.target.checked)}catch(R){console.error("Failed to toggle La Poste:",R)}},a=async()=>{if(o)try{await c(t)}catch(b){console.error("Failed to remove device:",b)}},T=b=>{const W=b.trim().toUpperCase().replace(/[^0-9A-F]/g,"").slice(-8);I(W)},B=b=>{const R=b.trim().toUpperCase();C(R)};return o?n(A,{sx:{my:2},children:[n(k,{variant:"subtitle1",gutterBottom:!0,children:e("devices.title")}),n(Qt,{sx:{mb:2}}),n(Zt,{children:n(Jt,{children:n(A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[n(ye,{label:e("devices.device_name"),value:i,onChange:b=>g(b.currentTarget.value),fullWidth:!0,size:"small"}),o.role===eo.Admin&&n(ye,{label:e("settings:configuration_key.label"),value:m,onChange:b=>T(b.currentTarget.value),fullWidth:!0,size:"small",type:u.key?"text":"password",helperText:e("settings:configuration_key.helper"),slotProps:{input:{endAdornment:n(et,{position:"end",children:n(Fe,{"aria-label":e("settings:toggle_key_visibility"),onClick:()=>_("key"),edge:"end",size:"small",children:u.key?n(tt,{}):n(ot,{})})})}}}),n(ye,{label:e("settings:door_pin_code"),value:y,onChange:b=>B(b.currentTarget.value),fullWidth:!0,size:"small",type:u.pin?"text":"password",slotProps:{input:{endAdornment:n(et,{position:"end",children:n(Fe,{"aria-label":e("settings:toggle_pin_visibility"),onClick:()=>_("pin"),edge:"end",size:"small",children:u.pin?n(tt,{}):n(ot,{})})})}}}),o.hardware_version==="4.0"&&o.software_revision&&mt(o.software_revision,"4.2.0")>0&&n(A,{children:n(to,{control:n(oo,{checked:o.la_poste_activated||!1,onChange:f}),label:e("settings:activate_la_poste")})}),n(A,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[n(Z,{size:"small",color:"error",variant:"outlined",onClick:a,children:e("devices.forget")}),n(Z,{size:"small",variant:"contained",onClick:h,children:e("save")})]})]})})})]}):null};var gt=(t=>(t[t.LA_POSTE=1]="LA_POSTE",t[t.VIGIK_TERTIARY=2]="VIGIK_TERTIARY",t[t.USER_BADGE=3]="USER_BADGE",t))(gt||{}),w=(t=>(t.IDLE="idle",t.SCANNING="scanning",t.FOUND="found",t.TIMEOUT="timeout",t.ERROR_EXISTS="error_exists",t.ERROR="error",t))(w||{});const nn=()=>{const{activeDevice:t}=Me(),{sendRequest:e}=no(),{addListener:o,removeListener:r}=ro(),[c,s]=U(E(w.IDLE),"scanStatus"),[u,p]=U(E(null),"scannedUid"),i=t?.id,g=lo(()=>i?te.nfc_tags.where("device_id").equals(i).toArray():[],[i]),m=oe(async()=>{if(!i)throw new Error("No active device");const h=await te.device_secrets.get(i);if(!h?.configuration_key)throw new Error("Configuration Key required");return h.configuration_key},[i]),I=oe(async()=>{try{const h=await m();s(w.SCANNING),p(null),await e(new so(h))}catch(h){console.error("Failed to start scan",h),s(w.ERROR)}},[m,e]);F(()=>{const h=f=>{if([H.NOTIFY_NFC_TAG_REGISTER_SCAN_RESULT,H.NOTIFY_NFC_TAG_REGISTER_SCAN_ERROR_EXISTS,H.NOTIFY_NFC_TAG_REGISTER_SCAN_TIMEOUT].includes(f.opcode)){const a=new ao(f.opcode);switch(a.parse(f.payload),a.status){case Be.TIMEOUT:s(w.TIMEOUT);break;case Be.ALREADY_EXISTS:s(w.ERROR_EXISTS),a.uid&&p(a.uid);break;case Be.FOUND:s(w.FOUND),a.uid&&p(a.uid);break;default:s(w.ERROR)}}};return o(H.NOTIFY_NFC_TAG_REGISTER_SCAN_RESULT,h),o(H.NOTIFY_NFC_TAG_REGISTER_SCAN_ERROR_EXISTS,h),o(H.NOTIFY_NFC_TAG_REGISTER_SCAN_TIMEOUT,h),()=>{r(H.NOTIFY_NFC_TAG_REGISTER_SCAN_RESULT,h),r(H.NOTIFY_NFC_TAG_REGISTER_SCAN_ERROR_EXISTS,h),r(H.NOTIFY_NFC_TAG_REGISTER_SCAN_TIMEOUT,h)}},[o,r]);const y=oe(async h=>{if(!(!u||!i))try{const f=await m(),a=new Uint8Array(u.split(":").map(b=>parseInt(b,16))),T=new io(f,a);await e(T);const B=await te.nfc_tags.where({device_id:i,uid:u}).first();B?await te.nfc_tags.update(B.id,{name:h,updated_at:Date.now()}):await te.nfc_tags.add({id:crypto.randomUUID(),device_id:i,uid:u,name:h,type:gt.USER_BADGE,created_at:Date.now(),sync_status:"created"}),s(w.IDLE),p(null)}catch(f){throw console.error("Failed to register tag",f),f}},[u,i,m,e]),C=oe(async h=>{if(i)try{const f=await m(),a=new Uint8Array(h.uid.split(":").map(B=>parseInt(B,16))),T=new co(f,a);await e(T),await te.nfc_tags.delete(h.id)}catch(f){throw console.error("Failed to unregister tag",f),f}},[i,m,e]),_=oe(()=>{s(w.IDLE),p(null)},[]);return{tags:g,scanStatus:c,scannedUid:u,startScan:I,registerTag:y,unregisterTag:C,resetScan:_}},rn=()=>{const{t}=Le(["common","settings"]),{tags:e,scanStatus:o,scannedUid:r,startScan:c,registerTag:s,unregisterTag:u,resetScan:p}=nn(),[i,g]=U(E(!1),"openAddDialog"),[m,I]=U(E(""),"tagName"),y=()=>{p(),I(""),g(!0)},C=()=>{g(!1),p()},_=()=>{c()},h=async()=>{if(m.trim())try{await s(m.trim()),C()}catch(a){console.error(a)}},f=async a=>{if(confirm(t("common:confirm_delete")))try{await u(a)}catch(T){console.error(T),alert("Failed to delete tag")}};return F(()=>{r&&!m&&I(`Badge ${r.substring(0,5)}`)},[r,m]),n(A,{sx:{p:2},children:[n(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[n(k,{variant:"h6",children:"NFC Tags"}),n(Z,{variant:"contained",startIcon:n(vo,{}),onClick:y,children:"Add Tag"})]}),e&&e.length>0?n(ht,{children:e.map(a=>n(ft,{secondaryAction:n(Fe,{edge:"end","aria-label":"delete",onClick:()=>f(a),children:n(So,{})}),children:[n(ko,{children:n(Ro,{children:n(tn,{})})}),n(bt,{primary:a.name,secondary:n(Ie,{children:[n(k,{component:"span",variant:"body2",color:"textPrimary",children:a.uid}),n("br",{}),a.last_seen_at?`Last seen: ${new Date(a.last_seen_at).toLocaleString()}`:"Never seen"]})})]},a.id))}):n(k,{variant:"body1",color:"textSecondary",align:"center",sx:{mt:4},children:"No NFC tags registered."}),n(uo,{open:i,onClose:C,fullWidth:!0,maxWidth:"sm",children:[n(po,{children:"Add NFC Tag"}),n(ho,{children:n(A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,py:2},children:[o===w.IDLE&&n(k,{children:'Click "Start Scan" and present the tag to the Boks.'}),o===w.SCANNING&&n(Ie,{children:[n(fo,{}),n(k,{children:"Scanning... (6s)"})]}),o===w.TIMEOUT&&n(ve,{severity:"warning",children:"Scan timed out. Please try again."}),o===w.ERROR&&n(ve,{severity:"error",children:"An error occurred during scan."}),o===w.ERROR_EXISTS&&n(ve,{severity:"info",children:["Tag already exists on device!",r&&n(A,{sx:{mt:1},children:[n(k,{variant:"caption",children:["UID: ",r]}),n(k,{children:"You can register it locally if it's not in the list."})]})]}),(o===w.FOUND||o===w.ERROR_EXISTS)&&r&&n(A,{sx:{width:"100%",mt:2},children:[n(ve,{severity:"success",sx:{mb:2},children:["Tag Found: ",r]}),n(ye,{autoFocus:!0,margin:"dense",label:"Tag Name",fullWidth:!0,value:m,onChange:a=>I(a.target.value)})]})]})}),n(bo,{children:[n(Z,{onClick:C,children:"Cancel"}),o===w.IDLE||o===w.TIMEOUT||o===w.ERROR?n(Z,{onClick:_,variant:"contained",children:"Start Scan"}):null,(o===w.FOUND||o===w.ERROR_EXISTS)&&n(Z,{onClick:h,variant:"contained",disabled:!m,children:"Add Tag"})]})]})]})};function Pe(t){const{children:e,value:o,index:r,...c}=t;return n("div",{role:"tabpanel",hidden:o!==r,id:`my-boks-tabpanel-${r}`,"aria-labelledby":`my-boks-tab-${r}`,...c,children:o===r&&n(A,{sx:{p:3},children:e})})}function De(t){return{id:`my-boks-tab-${t}`,"aria-controls":`my-boks-tabpanel-${t}`}}const cn=()=>{const{t}=Le(["common","codes","logs","settings"]),{activeDevice:e,knownDevices:o,setActiveDevice:r}=Me(),{isConnected:c}=mo(),s=go(),[u,p]=U(E(0),"value"),[i,g]=U(E(null),"selectedDeviceId");F(()=>{const T=new URLSearchParams(s.search).get("tab"),B=setTimeout(()=>{switch(T){case"settings":p(0);break;case"users":p(1);break;default:p(0);break}},0);return()=>clearTimeout(B)},[s.search]),F(()=>{(!e||!o.some(a=>a.id===e.id))&&i!==null&&setTimeout(()=>g(null),0)},[e,o,i]);const m=(a,T)=>{p(T)},I=a=>{g(a),r(a)},y=()=>{g(null),r(null)},C=o.length>1&&!i&&!e,_=e&&e.hardware_version==="4.0"&&e.software_revision&&mt(e.software_revision,"4.3.3")>0;let h=t("common:my_boks");return e&&o.length===1||e&&o.length>1?h=e.friendly_name||e.ble_name:!e&&o.length===1&&(h=o[0].friendly_name||o[0].ble_name),C?n(A,{sx:{p:3},children:[n(k,{variant:"h5",gutterBottom:!0,children:t("common:my_boks")}),n(ht,{children:o.map(a=>n(ft,{onClick:()=>I(a.id),sx:{cursor:"pointer"},children:n(bt,{primary:a.friendly_name||a.ble_name,secondary:a.ble_name})},a.id))})]}):e||o.find(a=>a.id===i)||(o.length===1?o[0]:null)?n(A,{sx:{width:"100%"},children:[n(A,{sx:{p:3,borderBottom:1,borderColor:"divider"},children:[o.length>1&&n(Z,{startIcon:n(en,{}),onClick:y,sx:{mb:1},children:t("common:back_to_list")}),n(k,{variant:"h4",component:"h1",gutterBottom:!0,children:h}),n(k,{variant:"subtitle1",color:"textSecondary",children:t(c?"common:connected":"common:disconnected")})]}),n(A,{sx:{borderBottom:1,borderColor:"divider"},children:n(Jo,{value:u,onChange:m,"aria-label":"my boks tabs",children:[n(ke,{label:t("settings:title"),...De(0)}),n(ke,{label:t("common:users.title"),...De(1)}),_&&n(ke,{label:"Tags NFC",...De(2)})]})}),n(Pe,{value:u,index:0,children:n(on,{deviceId:e?.id||""})}),n(Pe,{value:u,index:1,children:n(A,{sx:{p:3},children:[n(k,{variant:"h6",children:t("common:users.title")}),n(k,{variant:"body1",color:"textSecondary",children:t("common:coming_soon")})]})}),_&&n(Pe,{value:u,index:2,children:n(rn,{})})]}):n(A,{sx:{p:3},children:[n(k,{variant:"h5",children:t("common:my_boks")}),n(k,{variant:"body1",color:"textSecondary",children:t("common:no_active_device")})]})};export{cn as MyBoksPage};
