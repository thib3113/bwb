import{D as G,z as st,b as e,c as N,ac as Ve,ad as xe,ae as lt,af as ct,ag as dt,d as Y,g as K,O as je,_ as Oe,E as pt,ah as We,a as te,u as Q,Z as ut,R as M,s as L,e as B,ai as ue,aj as Te,ak as ke,f as ee,Q as oe,P as He,al as mt,am as qe,an as ie,ao as Ge,h as ce,ap as ft,aq as gt,k as De,t as $,l as W,a1 as Ye,ar as yt,as as bt,at as Ne,au as ht,av as Z,i as de,T as m,o as S,aw as E,n as _,C as ae,ax as Ke,H as se,F as le,I as Qe,ay as vt,az as Fe,a6 as Pe,aA as xt,a8 as Xe,aB as St,aC as Ct,a9 as wt,aa as It,ab as Lt,aD as zt,aE as Tt,K as kt,aF as Dt,aG as Pt,aH as _t,j as Rt,aI as Mt,q as $t,aJ as At,U as Bt,Y as J,aK as Ut}from"./index-BvXgzIyT.js";import{s as Vt,u as Wt,C as Nt}from"./Container-C3kOLHq_.js";import{C as Ft}from"./Chip-DN7A7K0l.js";const Et=pt(),jt=Vt("div",{name:"MuiStack",slot:"Root"});function Ot(t){return Wt({props:t,name:"MuiStack",defaultTheme:Et})}function Ht(t,r){const n=je.toArray(t).filter(Boolean);return n.reduce((o,l,s)=>(o.push(l),s<n.length-1&&o.push(Oe(r,{key:`separator-${s}`})),o),[])}const qt=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Gt=({ownerState:t,theme:r})=>{let n={display:"flex",flexDirection:"column",...Ve({theme:r},xe({values:t.direction,breakpoints:r.breakpoints.values}),o=>({flexDirection:o}))};if(t.spacing){const o=lt(r),l=Object.keys(r.breakpoints.values).reduce((d,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(d[u]=!0),d),{}),s=xe({values:t.direction,base:l}),b=xe({values:t.spacing,base:l});typeof s=="object"&&Object.keys(s).forEach((d,u,y)=>{if(!s[d]){const a=u>0?s[y[u-1]]:"column";s[d]=a}}),n=ct(n,Ve({theme:r},b,(d,u)=>t.useFlexGap?{gap:We(o,d)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${qt(u?s[u]:t.direction)}`]:We(o,d)}}))}return n=dt(r.breakpoints,n),n};function Yt(t={}){const{createStyledComponent:r=jt,useThemeProps:n=Ot,componentName:o="MuiStack"}=t,l=()=>Y({root:["root"]},d=>K(o,d),{}),s=r(Gt);return G(function(d,u){const y=n(d),c=st(y),{component:a="div",direction:x="column",spacing:f=0,divider:v,children:p,className:g,useFlexGap:h=!1,...C}=c,T={direction:x,spacing:f,useFlexGap:h},w=l();return e(s,{as:a,ownerState:T,ref:u,className:N(w.root,g),...C,children:v?Ht(p,v):p})})}function Kt(t){return K("MuiLinearProgress",t)}te("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const we=4,Ie=ke`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Qt=typeof Ie!="string"?Te`
        animation: ${Ie} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,Le=ke`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Xt=typeof Le!="string"?Te`
        animation: ${Le} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,ze=ke`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Zt=typeof ze!="string"?Te`
        animation: ${ze} 3s infinite linear;
      `:null,Jt=t=>{const{classes:r,variant:n,color:o}=t,l={root:["root",`color${M(o)}`,n],dashed:["dashed",`dashedColor${M(o)}`],bar1:["bar","bar1",`barColor${M(o)}`,(n==="indeterminate"||n==="query")&&"bar1Indeterminate",n==="determinate"&&"bar1Determinate",n==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",n!=="buffer"&&`barColor${M(o)}`,n==="buffer"&&`color${M(o)}`,(n==="indeterminate"||n==="query")&&"bar2Indeterminate",n==="buffer"&&"bar2Buffer"]};return Y(l,Kt,r)},_e=(t,r)=>t.vars?t.vars.palette.LinearProgress[`${r}Bg`]:t.palette.mode==="light"?t.lighten(t.palette[r].main,.62):t.darken(t.palette[r].main,.5),er=L("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[`color${M(n.color)}`],r[n.variant]]}})(B(({theme:t})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(t.palette).filter(ue()).map(([r])=>({props:{color:r},style:{backgroundColor:_e(t,r)}})),{props:({ownerState:r})=>r.color==="inherit"&&r.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),tr=L("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.dashed,r[`dashedColor${M(n.color)}`]]}})(B(({theme:t})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(t.palette).filter(ue()).map(([r])=>{const n=_e(t,r);return{props:{color:r},style:{backgroundImage:`radial-gradient(${n} 0%, ${n} 16%, transparent 42%)`}}})]})),Zt||{animation:`${ze} 3s infinite linear`}),rr=L("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.bar,r.bar1,r[`barColor${M(n.color)}`],(n.variant==="indeterminate"||n.variant==="query")&&r.bar1Indeterminate,n.variant==="determinate"&&r.bar1Determinate,n.variant==="buffer"&&r.bar1Buffer]}})(B(({theme:t})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(t.palette).filter(ue()).map(([r])=>({props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main}})),{props:{variant:"determinate"},style:{transition:`transform .${we}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${we}s linear`}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:Qt||{animation:`${Ie} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),nr=L("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.bar,r.bar2,r[`barColor${M(n.color)}`],(n.variant==="indeterminate"||n.variant==="query")&&r.bar2Indeterminate,n.variant==="buffer"&&r.bar2Buffer]}})(B(({theme:t})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(t.palette).filter(ue()).map(([r])=>({props:{color:r},style:{"--LinearProgressBar2-barColor":(t.vars||t).palette[r].main}})),{props:({ownerState:r})=>r.variant!=="buffer"&&r.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:r})=>r.variant!=="buffer"&&r.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(t.palette).filter(ue()).map(([r])=>({props:{color:r,variant:"buffer"},style:{backgroundColor:_e(t,r),transition:`transform .${we}s linear`}})),{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:Xt||{animation:`${Le} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),or=G(function(r,n){const o=Q({props:r,name:"MuiLinearProgress"}),{className:l,color:s="primary",value:b,valueBuffer:i,variant:d="indeterminate",...u}=o,y={...o,color:s,variant:d},c=Jt(y),a=ut(),x={},f={bar1:{},bar2:{}};if((d==="determinate"||d==="buffer")&&b!==void 0){x["aria-valuenow"]=Math.round(b),x["aria-valuemin"]=0,x["aria-valuemax"]=100;let v=b-100;a&&(v=-v),f.bar1.transform=`translateX(${v}%)`}if(d==="buffer"&&i!==void 0){let v=(i||0)-100;a&&(v=-v),f.bar2.transform=`translateX(${v}%)`}return e(er,{className:N(c.root,l),ownerState:y,role:"progressbar",...x,ref:n,...u,children:[d==="buffer"?e(tr,{className:c.dashed,ownerState:y}):null,e(rr,{className:c.bar1,ownerState:y,style:f.bar1}),d==="determinate"?null:e(nr,{className:c.bar2,ownerState:y,style:f.bar2})]})});function ar(t){return K("MuiMobileStepper",t)}te("MuiMobileStepper",["root","positionBottom","positionTop","positionStatic","dots","dot","dotActive","progress"]);const ir=t=>{const{classes:r,position:n}=t,o={root:["root",`position${M(n)}`],dots:["dots"],dot:["dot"],dotActive:["dotActive"],progress:["progress"]};return Y(o,ar,r)},sr=L(He,{name:"MuiMobileStepper",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[`position${M(n.position)}`]]}})(B(({theme:t})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:(t.vars||t).palette.background.default,padding:8,variants:[{props:({position:r})=>r==="top"||r==="bottom",style:{position:"fixed",left:0,right:0,zIndex:(t.vars||t).zIndex.mobileStepper}},{props:{position:"top"},style:{top:0}},{props:{position:"bottom"},style:{bottom:0}}]}))),lr=L("div",{name:"MuiMobileStepper",slot:"Dots"})({variants:[{props:{variant:"dots"},style:{display:"flex",flexDirection:"row"}}]}),cr=L("div",{name:"MuiMobileStepper",slot:"Dot",shouldForwardProp:t=>mt(t)&&t!=="dotActive",overridesResolver:(t,r)=>{const{dotActive:n}=t;return[r.dot,n&&r.dotActive]}})(B(({theme:t})=>({variants:[{props:{variant:"dots"},style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),backgroundColor:(t.vars||t).palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"}},{props:{variant:"dots",dotActive:!0},style:{backgroundColor:(t.vars||t).palette.primary.main}}]}))),dr=L(or,{name:"MuiMobileStepper",slot:"Progress"})({variants:[{props:{variant:"progress"},style:{width:"50%"}}]}),pr=G(function(r,n){const o=Q({props:r,name:"MuiMobileStepper"}),{activeStep:l=0,backButton:s,className:b,LinearProgressProps:i,nextButton:d,position:u="bottom",steps:y,variant:c="dots",slots:a={},slotProps:x={},...f}=o,v={...o,activeStep:l,position:u,variant:c};let p;c==="progress"&&(y===1?p=100:p=Math.ceil(l/(y-1)*100));const g=ir(v),h={slots:a,slotProps:{progress:i,...x}},[C,T]=ee("root",{ref:n,elementType:sr,shouldForwardComponentProp:!0,className:N(g.root,b),externalForwardedProps:{...h,...f},ownerState:v,additionalProps:{square:!0,elevation:0}}),[w,k]=ee("dots",{className:g.dots,elementType:lr,externalForwardedProps:h,ownerState:v}),[I,D]=ee("dot",{elementType:cr,externalForwardedProps:h,ownerState:v}),[P,U]=ee("progress",{className:g.progress,elementType:dr,shouldForwardComponentProp:!0,externalForwardedProps:h,ownerState:v,additionalProps:{value:p,variant:"determinate"}});return e(C,{...T,children:[s,c==="text"&&e(oe,{children:[l+1," / ",y]}),c==="dots"&&e(w,{...k,children:[...new Array(y)].map((R,V)=>e(I,{...D,className:N(g.dot,D.className,V===l&&g.dotActive),dotActive:V===l},V))}),c==="progress"&&e(P,{...U}),d]})}),A=Yt({createStyledComponent:L("div",{name:"MuiStack",slot:"Root"}),useThemeProps:t=>Q({props:t,name:"MuiStack"})}),fe=qe({}),Re=qe({});function ur(t){return K("MuiStep",t)}te("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const mr=t=>{const{classes:r,orientation:n,alternativeLabel:o,completed:l}=t;return Y({root:["root",n,o&&"alternativeLabel",l&&"completed"]},ur,r)},fr=L("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[n.orientation],n.alternativeLabel&&r.alternativeLabel,n.completed&&r.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),gr=G(function(r,n){const o=Q({props:r,name:"MuiStep"}),{active:l,children:s,className:b,component:i="div",completed:d,disabled:u,expanded:y=!1,index:c,last:a,...x}=o,{activeStep:f,connector:v,alternativeLabel:p,orientation:g,nonLinear:h}=ie(fe);let[C=!1,T=!1,w=!1]=[l,d,u];f===c?C=l!==void 0?l:!0:!h&&f>c?T=d!==void 0?d:!0:!h&&f<c&&(w=u!==void 0?u:!0);const k=Ge(()=>({index:c,last:a,expanded:y,icon:c+1,active:C,completed:T,disabled:w}),[c,a,y,C,T,w]),I={...o,active:C,orientation:g,alternativeLabel:p,completed:T,disabled:w,expanded:y,component:i},D=mr(I),P=e(fr,{as:i,className:N(D.root,b),ref:n,ownerState:I,...x,children:[v&&p&&c!==0?v:null,s]});return e(Re.Provider,{value:k,children:v&&!p&&c!==0?e(oe,{children:[v,P]}):P})}),yr=ce(e("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),br=ce(e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function hr(t){return K("MuiStepIcon",t)}const Se=te("MuiStepIcon",["root","active","completed","error","text"]);var Ee;const vr=t=>{const{classes:r,active:n,completed:o,error:l}=t;return Y({root:["root",n&&"active",o&&"completed",l&&"error"],text:["text"]},hr,r)},Ce=L(ft,{name:"MuiStepIcon",slot:"Root"})(B(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${Se.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${Se.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${Se.error}`]:{color:(t.vars||t).palette.error.main}}))),xr=L("text",{name:"MuiStepIcon",slot:"Text"})(B(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}))),Sr=G(function(r,n){const o=Q({props:r,name:"MuiStepIcon"}),{active:l=!1,className:s,completed:b=!1,error:i=!1,icon:d,...u}=o,y={...o,active:l,completed:b,error:i},c=vr(y);if(typeof d=="number"||typeof d=="string"){const a=N(s,c.root);return i?e(Ce,{as:br,className:a,ref:n,ownerState:y,...u}):b?e(Ce,{as:yr,className:a,ref:n,ownerState:y,...u}):e(Ce,{className:a,ref:n,ownerState:y,...u,children:[Ee||(Ee=e("circle",{cx:"12",cy:"12",r:"12"})),e(xr,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:y,children:d})]})}return d});function Cr(t){return K("MuiStepLabel",t)}const q=te("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),wr=t=>{const{classes:r,orientation:n,active:o,completed:l,error:s,disabled:b,alternativeLabel:i}=t;return Y({root:["root",n,s&&"error",b&&"disabled",i&&"alternativeLabel"],label:["label",o&&"active",l&&"completed",s&&"error",b&&"disabled",i&&"alternativeLabel"],iconContainer:["iconContainer",o&&"active",l&&"completed",s&&"error",b&&"disabled",i&&"alternativeLabel"],labelContainer:["labelContainer",i&&"alternativeLabel"]},Cr,r)},Ir=L("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[n.orientation]]}})({display:"flex",alignItems:"center",[`&.${q.alternativeLabel}`]:{flexDirection:"column"},[`&.${q.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Lr=L("span",{name:"MuiStepLabel",slot:"Label"})(B(({theme:t})=>({...t.typography.body2,display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${q.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${q.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${q.alternativeLabel}`]:{marginTop:16},[`&.${q.error}`]:{color:(t.vars||t).palette.error.main}}))),zr=L("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${q.alternativeLabel}`]:{paddingRight:0}}),Tr=L("span",{name:"MuiStepLabel",slot:"LabelContainer"})(B(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${q.alternativeLabel}`]:{textAlign:"center"}}))),Ze=G(function(r,n){const o=Q({props:r,name:"MuiStepLabel"}),{children:l,className:s,componentsProps:b={},error:i=!1,icon:d,optional:u,slots:y={},slotProps:c={},StepIconComponent:a,StepIconProps:x,...f}=o,{alternativeLabel:v,orientation:p}=ie(fe),{active:g,disabled:h,completed:C,icon:T}=ie(Re),w=d||T;let k=a;w&&!k&&(k=Sr);const I={...o,active:g,alternativeLabel:v,completed:C,disabled:h,error:i,orientation:p},D=wr(I),P={slots:y,slotProps:{stepIcon:x,...b,...c}},[U,R]=ee("root",{elementType:Ir,externalForwardedProps:{...P,...f},ownerState:I,ref:n,className:N(D.root,s)}),[V,re]=ee("label",{elementType:Lr,externalForwardedProps:P,ownerState:I}),[F,ge]=ee("stepIcon",{elementType:k,externalForwardedProps:P,ownerState:I});return e(U,{...R,children:[w||F?e(zr,{className:D.iconContainer,ownerState:I,children:e(F,{completed:C,active:g,error:i,icon:w,...ge})}):null,e(Tr,{className:D.labelContainer,ownerState:I,children:[l?e(V,{...re,className:N(D.label,re?.className),children:l}):null,u]})]})});Ze.muiName="StepLabel";function kr(t){return K("MuiStepConnector",t)}te("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Dr=t=>{const{classes:r,orientation:n,alternativeLabel:o,active:l,completed:s,disabled:b}=t,i={root:["root",n,o&&"alternativeLabel",l&&"active",s&&"completed",b&&"disabled"],line:["line",`line${M(n)}`]};return Y(i,kr,r)},Pr=L("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[n.orientation],n.alternativeLabel&&r.alternativeLabel,n.completed&&r.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),_r=L("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.line,r[`line${M(n.orientation)}`]]}})(B(({theme:t})=>{const r=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return{display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:r,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),Rr=G(function(r,n){const o=Q({props:r,name:"MuiStepConnector"}),{className:l,...s}=o,{alternativeLabel:b,orientation:i="horizontal"}=ie(fe),{active:d,disabled:u,completed:y}=ie(Re),c={...o,alternativeLabel:b,orientation:i,active:d,completed:y,disabled:u},a=Dr(c);return e(Pr,{className:N(a.root,l),ref:n,ownerState:c,...s,children:e(_r,{className:a.line,ownerState:c})})});function Mr(t){return K("MuiStepper",t)}te("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const $r=t=>{const{orientation:r,nonLinear:n,alternativeLabel:o,classes:l}=t;return Y({root:["root",r,n&&"nonLinear",o&&"alternativeLabel"]},Mr,l)},Ar=L("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[n.orientation],n.alternativeLabel&&r.alternativeLabel,n.nonLinear&&r.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Br=e(Rr,{}),Ur=G(function(r,n){const o=Q({props:r,name:"MuiStepper"}),{activeStep:l=0,alternativeLabel:s=!1,children:b,className:i,component:d="div",connector:u=Br,nonLinear:y=!1,orientation:c="horizontal",...a}=o,x={...o,nonLinear:y,alternativeLabel:s,orientation:c,component:d},f=$r(x),v=je.toArray(b).filter(Boolean),p=v.map((h,C)=>Oe(h,{index:C,last:C+1===v.length,...h.props})),g=Ge(()=>({activeStep:l,alternativeLabel:s,connector:u,nonLinear:y,orientation:c}),[l,s,u,y,c]);return e(fe.Provider,{value:g,children:e(Ar,{as:d,ownerState:x,className:N(f.root,i),ref:n,...a,children:p})})}),Vr=ce(e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),Wr=ce(e("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Nr=ce(e("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1m-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1"})),Fr=ce(e("path",{d:"M19.8 18.4 14 10.67V6.5l1.35-1.69c.26-.33.03-.81-.39-.81H9.04c-.42 0-.65.48-.39.81L10 6.5v4.17L4.2 18.4c-.49.66-.02 1.6.8 1.6h14c.82 0 1.29-.94.8-1.6"})),Er=()=>{const t=ie(gt);if(t===void 0)throw new Error("useSession must be used within a SessionProvider");return t},jr=t=>{const{readCharacteristic:r}=De(),[n,o]=$(W(!1),"isReading"),[l,s]=$(W(t?.batteryData||null),"batteryData"),[b,i]=$(W(t?.analysis||null),"analysis"),d=Ye(async(u,y)=>{if(!u||!u.gatt||!u.gatt.connected)throw new Error("Device not connected");console.log("[BatteryDiag] Starting diagnostics using context read..."),o(!0);const c={standardLevel:null,standardError:null,rawHex:null,serviceUuid:null,parsed:null,error:null};try{try{console.log("[BatteryDiag] Reading Standard Battery Service...");const a=await r(yt,bt);c.standardLevel=a.getUint8(0),console.log("[BatteryDiag] Standard Level:",c.standardLevel)}catch(a){const x=a instanceof Error?a.message:String(a);console.warn("[BatteryDiag] Standard Battery Read Failed:",x),c.standardError=x}try{console.log("[BatteryDiag] Reading Proprietary Battery Characteristic...");const a=await r(Ne,ht),x=new Uint8Array(a.buffer);c.rawHex=Array.from(x).map(g=>g.toString(16).padStart(2,"0").toUpperCase()).join(" "),c.serviceUuid=Ne,console.log("[BatteryDiag] Proprietary Data (HEX):",c.rawHex);const f=a.byteLength;let v="Unknown";f===1?v="Single Measure":f===4?v="T1/T5/T10":f===6&&(v="Min/Mean/Max");const p={format:v};if(f===1)p.level=a.getUint8(0);else if(f===4)p.level=a.getUint8(0),p.t1=a.getUint8(1),p.t5=a.getUint8(2),p.temp_C=a.getUint8(3)-25;else if(f===6){const g=new Uint8Array(a.buffer),h=C=>C===Z;h(g[0])&&h(g[1])&&h(g[2])&&h(g[3])&&h(g[4])?c.error="Données invalides (255)":(p.first_mV=g[0]===Z?null:g[0]*100,p.min_mV=g[1]===Z?null:g[1]*100,p.mean_mV=g[2]===Z?null:g[2]*100,p.max_mV=g[3]===Z?null:g[3]*100,p.last_mV=g[4]===Z?null:g[4]*100,p.temp_C=g[5]===Z?null:g[5]-25)}else p.rawLength=f;c.parsed=p}catch(a){const x=a instanceof Error?a.message:String(a);console.error("[BatteryDiag] Proprietary Read Error:",x),c.error=x}if(s(c),c.parsed)try{const a=Or(c,y);i(a)}catch(a){console.error("Error analyzing battery data:",a);const x=a instanceof Error?a.message:String(a);c.error=(c.error||"")+` | Analysis failed: ${x}`}}catch(a){console.error("[BatteryDiag] Global Error:",a)}finally{o(!1)}},[r]);return{isReading:n,batteryData:l,analysis:b,readBatteryDiagnostics:d}};function Or(t,r){const n={userClaimType:null,userClaimText:"Inconnue",detectedType:"Unknown",detectedText:"Incertain",finalType:"aaa",consistencyStatus:"neutral",consistencyText:""};if(!t.parsed)return n.consistencyStatus="error",n.consistencyText="Données propriétaires non disponibles",n;const o=t.parsed.last_mV;return r&&(r.answer==="Oui"&&r.inference?(n.userClaimType=r.inference.battery,n.userClaimText=r.inference.label+" (Confirmé)"):r.answer==="Non"?(n.userClaimText="Infirmé par l'utilisateur",n.userClaimType="rejected"):r.answer==="Inconnu"&&(n.userClaimText="Inconnu (Utilisateur)",n.userClaimType="unknown")),o&&(o>5e3?(n.detectedType="aaa",n.detectedText="8x AAA ( > 5V )"):o<4500?(n.detectedType="lsh14",n.detectedText="LSH14 ( < 4.5V )"):n.detectedText=`Ambigu (${(o/1e3).toFixed(2)}V)`),n.userClaimType==="aaa"||n.userClaimType==="lsh14"?n.detectedType!=="Unknown"?n.userClaimType===n.detectedType?(n.finalType=n.detectedType||"aaa",n.consistencyStatus="success",n.consistencyText="✅ Cohérent : Le voltage confirme le matériel."):(n.finalType=n.detectedType||"aaa",n.consistencyStatus="error",n.consistencyText="❌ Incohérence : Le voltage contredit le matériel déclaré !"):(n.finalType=n.userClaimType,n.consistencyStatus="warning",n.consistencyText="⚠️ Voltage ambigu, utilisation du type déclaré."):n.detectedType!=="Unknown"?(n.finalType=n.detectedType||"aaa",n.consistencyStatus="success",n.consistencyText="ℹ️ Type déduit automatiquement du voltage."):(n.finalType="aaa",n.consistencyStatus="warning",n.consistencyText="⚠️ Impossible de déterminer le type (Voltage ambigu). Par défaut : AAA."),n}const Hr=({isConnected:t,isConnecting:r,connect:n,error:o,device:l,firmwareVersion:s,isLoadingInfo:b,onRetryFetch:i})=>{const{t:d}=de(["wizard","common"]);return e(S,{sx:{mt:2},children:[e(m,{variant:"h6",gutterBottom:!0,children:d("connect.title")}),e(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:d("connect.desc")}),t?e(se,{variant:"outlined",sx:{mt:2,borderColor:"success.main"},children:e(le,{children:[e(A,{direction:"row",alignItems:"center",spacing:2,sx:{mb:2},children:[e(Vr,{color:"success",fontSize:"large"}),e(S,{children:[e(m,{variant:"h6",color:"success.main",children:d("connect.success")}),e(m,{variant:"body2",color:"text.secondary",children:d("connect.ready")})]})]}),e(Qe,{sx:{my:2}}),e(m,{variant:"subtitle2",gutterBottom:!0,children:"Informations de l'appareil :"}),e(A,{spacing:1,children:[e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.secondary",children:"Nom :"}),e(m,{variant:"body2",fontWeight:"medium",children:l?.name||"Inconnu"})]}),e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.secondary",children:"ID :"}),e(m,{variant:"body2",fontWeight:"medium",children:l?.id||"Inconnu"})]}),e(S,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e(m,{variant:"body2",color:"text.secondary",children:"Firmware :"}),e(S,{display:"flex",alignItems:"center",gap:1,children:[e(m,{variant:"body2",fontWeight:"medium",children:b?e(ae,{size:12}):s||"Inconnu"}),!b&&e(_,{size:"small",onClick:i,sx:{minWidth:0,p:.5},children:e(vt,{sx:{fontSize:16}})})]})]})]})]})}):e(S,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,py:4},children:[o&&e(E,{severity:"error",sx:{width:"100%",mb:2},children:o.startsWith("errors.")?d(`common:${o}`):o}),e(_,{variant:"contained",size:"large",startIcon:r?e(ae,{size:20,color:"inherit"}):e(Ke,{}),onClick:()=>n(),disabled:r,children:d(r?"common:connecting":"connect.button")})]})]})},qr=({pinCode:t,updateDebugWizardState:r,onOpenDoor:n,isOpening:o,isConnected:l,openDoorSuccess:s,openDoorError:b,batteryData:i,waitingForClose:d,isReadingBattery:u,isPreparing:y,analysis:c})=>{const{t:a}=de();return e(S,{sx:{mt:2},children:[e(m,{variant:"h6",gutterBottom:!0,children:a("wizard:door.title")}),e(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:a("wizard:door.desc")}),e(A,{spacing:3,children:[e(se,{variant:"outlined",children:e(le,{children:[e(A,{direction:"row",alignItems:"center",spacing:1,sx:{mb:2},children:[e(Fe,{color:"primary"}),e(m,{variant:"h6",children:a("wizard:door.open")})]}),e(S,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(Pe,{label:a("codes:pin_label"),variant:"outlined",size:"small",value:t||"",onChange:x=>{const f=x.currentTarget.value.toUpperCase();/^[0-9AB]*$/.test(f)&&f.length<=6&&r({pinCode:f})},placeholder:a("wizard:door.pin_placeholder"),type:"text",fullWidth:!0,inputProps:{maxLength:6}}),e(_,{variant:"contained",onClick:n,disabled:o||!l,startIcon:o?e(ae,{size:20,color:"inherit"}):e(Fe,{}),children:a(o?"wizard:door.opening":"wizard:door.open")}),s&&!b&&e(E,{severity:"success",children:a("wizard:door.success")}),b&&e(E,{severity:"error",children:b})]})]})}),e(se,{variant:"outlined",children:e(le,{children:[e(A,{direction:"row",alignItems:"center",spacing:1,sx:{mb:2},children:[e(xt,{color:"primary"}),e(m,{variant:"h6",children:a("battery_level")})]}),e(S,{sx:{display:"flex",flexDirection:"column",gap:2},children:[!i&&!d&&!u&&!y&&e(E,{severity:"info",children:a("wizard:battery.wait")}),d&&e(E,{severity:"info",icon:e(ae,{size:20}),children:a("wizard:battery.waiting_close")}),(u||y)&&e(E,{severity:"info",icon:e(ae,{size:20}),children:a("wizard:battery.analyzing")}),i&&e(S,{sx:{mt:2,p:2,bgcolor:"background.paper",borderRadius:1,border:1,borderColor:"divider"},children:[e(S,{display:"flex",justifyContent:"space-between",mb:1,children:[e(m,{variant:"body2",color:"text.primary",children:[a("wizard:battery.standard_level"),":"]}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.standardLevel!==null?`${i.standardLevel}%`:"N/A"})]}),i.parsed&&e(oe,{children:[e(Qe,{sx:{my:1}}),e(m,{variant:"subtitle2",gutterBottom:!0,color:"text.primary",children:[a("wizard:battery.proprietary_data")," (",i.parsed.format,")"]}),i.parsed.level!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:[a("battery_level")," (Proprietary):"]}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:[i.parsed.level,"%"]})]}),i.parsed.first_mV!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"Voltage (First):"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.first_mV!==null?`${(i.parsed.first_mV/1e3).toFixed(2)} V`:"N/A"})]}),i.parsed.min_mV!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"Voltage (Min):"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.min_mV!==null?`${(i.parsed.min_mV/1e3).toFixed(2)} V`:"N/A"})]}),i.parsed.mean_mV!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"Voltage (Mean):"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.mean_mV!==null?`${(i.parsed.mean_mV/1e3).toFixed(2)} V`:"N/A"})]}),i.parsed.max_mV!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"Voltage (Max):"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.max_mV!==null?`${(i.parsed.max_mV/1e3).toFixed(2)} V`:"N/A"})]}),i.parsed.last_mV!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:[a("wizard:battery.voltage_last"),":"]}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.last_mV!==null?`${(i.parsed.last_mV/1e3).toFixed(2)} V`:"N/A"})]}),i.parsed.t1!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"T1:"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.t1})]}),i.parsed.t5!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:"T5:"}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.t5})]}),i.parsed.temp_C!==void 0&&e(S,{display:"flex",justifyContent:"space-between",children:[e(m,{variant:"body2",color:"text.primary",children:[a("wizard:battery.temperature"),":"]}),e(m,{variant:"body2",fontWeight:"bold",color:"text.primary",children:i.parsed.temp_C!==null?`${i.parsed.temp_C}°C`:"N/A"})]}),c&&e(S,{sx:{mt:2,p:1,border:"1px solid",borderColor:"divider",borderRadius:1,bgcolor:"background.paper"},children:[e(m,{variant:"caption",display:"block",color:"text.secondary",children:[a("wizard:battery.analysis"),":"]}),e(m,{variant:"body2",gutterBottom:!0,color:"text.primary",children:[a("wizard:battery.detected_type"),":"," ",e("strong",{children:c.detectedText})]}),e(m,{variant:"body2",color:c.consistencyStatus==="success"?"success.main":c.consistencyStatus==="error"?"error.main":"warning.main",fontWeight:"medium",children:c.consistencyText})]})]}),i.error&&e(E,{severity:"warning",sx:{mt:1},children:i.error})]})]})]})})]})]})},Gr=({questionAnswers:t,onAnswerQuestion:r})=>{const{t:n}=de(["wizard","common"]),o=[{id:"has_scale",text:n("questions.has_scale"),expected:"Non"},{id:"anything_special",text:n("questions.anything_special"),expected:"Non"}];return e(S,{sx:{mt:2},children:[e(m,{variant:"h6",gutterBottom:!0,children:n("questions.title")}),e(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:n("questions.desc")}),e(A,{spacing:2,children:o.map(l=>{const s=t.find(b=>b.id===l.id);return e(se,{variant:"outlined",children:e(le,{children:[e(A,{direction:"row",spacing:1,alignItems:"flex-start",mb:2,children:[e(Nr,{color:"action"}),e(m,{variant:"subtitle1",fontWeight:"medium",children:l.text})]}),e(A,{direction:"row",spacing:1,children:[e(_,{variant:s?.answer==="Oui"?"contained":"outlined",onClick:()=>r(l.id,"Oui",l.expected),color:s?.answer==="Oui"?"primary":"inherit",children:n("common:yes")}),e(_,{variant:s?.answer==="Non"?"contained":"outlined",onClick:()=>r(l.id,"Non",l.expected),color:s?.answer==="Non"?"primary":"inherit",children:n("common:no")}),e(_,{variant:s?.answer==="Inconnu"?"contained":"outlined",onClick:()=>r(l.id,"Inconnu",l.expected),color:s?.answer==="Inconnu"?"secondary":"inherit",children:n("common:unknown")})]})]})},l.id)})})]})},Yr=({customUuids:t,customResults:r,updateDebugWizardState:n})=>{const{t:o}=de(["wizard","common","codes"]),{connect:l,disconnect:s,device:b}=De(),[i,d]=$(W(!1),"showAdvanced"),[u,y]=$(W(""),"customUuidInput"),[c,a]=$(W(!1),"isDiscoveringCustom"),x=()=>{if(!u)return;const p=u.trim().toLowerCase();t.includes(p)||(n({customUuids:[...t,p]}),y(""))},f=p=>{n({customUuids:t.filter(g=>g!==p)})},v=async()=>{if(t.length!==0){a(!0);try{console.log("DebugWizard: Disconnecting for custom discovery..."),s(),await new Promise(h=>setTimeout(h,zt)),console.log("DebugWizard: Reconnecting with custom services:",t),await l(t),await new Promise(h=>setTimeout(h,Tt));const p=[],g=b;g?.gatt?.connected||console.warn("Device not marked as connected yet, checking GATT directly...");for(const h of t)try{console.log(`DebugWizard: Accessing service ${h}`);const C=g?.gatt;if(!C)continue;const w=await(await C.getPrimaryService(h)).getCharacteristics();for(const k of w)try{console.log(`DebugWizard: Reading characteristic ${k.uuid}`);const I=await k.readValue(),D=new Uint8Array(I.buffer),P=Array.from(D).map(U=>U.toString(16).padStart(2,"0").toUpperCase()).join(" ");p.push({serviceUuid:h,charUuid:k.uuid,value:P,timestamp:new Date().toISOString()})}catch(I){console.warn(`Failed to read char ${k.uuid} in service ${h}`,I)}}catch(C){console.warn(`Failed to access service ${h}`,C)}n({customResults:p})}catch(p){console.error("Custom discovery failed:",p)}finally{a(!1)}}};return e(S,{sx:{mt:2},children:[e(m,{variant:"h6",gutterBottom:!0,children:o("advanced.title")}),e(E,{severity:"info",sx:{mb:3},children:o("advanced.warning")}),e(A,{spacing:3,children:[e(se,{variant:"outlined",children:e(le,{children:[e(S,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>d(!i),children:[e(A,{direction:"row",alignItems:"center",spacing:1,children:[e(Fr,{color:"primary"}),e(m,{variant:"h6",children:o("advanced.tutorial_title")})]}),e(Xe,{children:i?e(Wr,{}):e(St,{})})]}),e(Ct,{in:i,children:e(S,{sx:{mt:3},children:[e(m,{variant:"body2",sx:{mb:2},children:o("advanced.tutorial_desc")}),e(A,{direction:"row",spacing:2,sx:{mt:2,justifyContent:"center"},children:[e(_,{variant:"outlined",href:"https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp",target:"_blank",rel:"noopener noreferrer",children:"Android (Play Store)"}),e(_,{variant:"outlined",href:"https://apps.apple.com/us/app/nrf-connect-for-mobile/id1054362403",target:"_blank",rel:"noopener noreferrer",children:"iOS (App Store)"})]})]})})]})}),e(se,{variant:"outlined",children:e(le,{children:[e(m,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:o("advanced.explorer_title")}),e(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:o("advanced.explorer_desc")}),e(S,{sx:{display:"flex",gap:1,mb:2},children:[e(Pe,{size:"small",fullWidth:!0,placeholder:"ex: 0000180f-0000-1000-8000-00805f9b34fb",value:u,onChange:p=>y(p.currentTarget.value),onKeyPress:p=>p.key==="Enter"&&x()}),e(_,{variant:"outlined",onClick:x,children:o("codes:add_new")})]}),e(S,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:3},children:t.map(p=>e(Ft,{label:p,onDelete:()=>f(p),size:"small",color:"primary",variant:"outlined"},p))}),e(_,{variant:"contained",fullWidth:!0,disabled:t.length===0||c,onClick:v,startIcon:c?e(ae,{size:20,color:"inherit"}):e(Ke,{}),children:o(c?"advanced.exploring":"advanced.explore_button")}),r.length>0&&e(S,{sx:{mt:3},children:[e(m,{variant:"subtitle2",gutterBottom:!0,children:["Résultats trouvés : ",r.length]}),e(wt,{dense:!0,children:r.map((p,g)=>e(It,{divider:!0,children:e(Lt,{primary:`Char: ${p.charUuid.substring(0,8)}...`,secondary:`Service: ${p.serviceUuid.substring(0,8)}... | Val: ${p.value}`,secondaryTypographyProps:{sx:{fontFamily:"monospace",fontSize:"0.75rem"}}})},g))})]})]})})]})]})},Kr=({device:t,firmwareVersion:r,hardwareInference:n,deviceInfo:o,batteryData:l,analysis:s,pinCode:b,openDoorSuccess:i,openDoorError:d,questionAnswers:u,customUuids:y,customResults:c,serviceUuid:a,serviceResults:x})=>{const{t:f}=de(["wizard","common","codes"]),[v,p]=$(W(!1),"copySuccess"),g={device:{name:t?.name,id:t?.id,firmwareVersion:r,hardwareInference:n,deviceInfo:o},status:{battery:l,analysis:s,doorTest:{attempted:!!b,success:i,error:d}},questionAnswers:u,customDiscovery:{uuids:y,results:c},advanced:{serviceUuid:a,results:x},timestamp:new Date().toISOString()},h=JSON.stringify(g,null,2),C=()=>{navigator.clipboard.writeText(h),p(!0)},T=!n||n.version==="Unknown",w=c.length>0,k=s?.consistencyStatus==="error"||s?.consistencyStatus==="warning",I=u.find(R=>R.id==="has_scale"&&R.answer==="Oui"),D=u.find(R=>R.id==="anything_special"&&R.answer==="Oui"),P=T||w||k||I||D,U=()=>{const R=`Debug Data: ${t?.name||"Unknown Boks"} - ${r||"Unknown FW"}`,V="```",re=`Please find below the debug data captured via the Boks Web BLE tool.

${V}json
${h}
${V}`,F=new URLSearchParams;return F.set("title",R),F.set("body",re),`${_t}?${F.toString()}`};return e(S,{sx:{mt:2},children:[e(m,{variant:"h6",gutterBottom:!0,children:f("recap.title")}),e(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:f("recap.desc")}),P&&e(E,{severity:"info",icon:e(kt,{}),sx:{mb:3},action:e(_,{color:"inherit",size:"small",href:U(),target:"_blank",onClick:()=>{},children:[" ",f("recap.open_issue")]}),children:f("recap.interesting_found")}),e(S,{sx:{position:"relative"},children:[e(Pe,{multiline:!0,fullWidth:!0,minRows:10,maxRows:20,value:h,variant:"outlined",InputProps:{readOnly:!0,style:{fontFamily:"monospace",fontSize:"0.875rem"}}}),e(Xe,{onClick:C,sx:{position:"absolute",top:8,right:8,bgcolor:"background.paper"},title:f("codes:copy_to_clipboard"),children:e(Dt,{})})]}),e(Pt,{open:v,autoHideDuration:3e3,onClose:()=>p(!1),message:"Données de débogage copiées dans le presse-papier"})]})},Jr=()=>{const{t}=de(),r=[t("wizard:steps.step1"),t("wizard:steps.step2"),t("wizard:steps.step3"),t("wizard:steps.step4"),t("wizard:steps.step5")],n=Rt(),o=Mt(n.breakpoints.down("sm")),{debugWizardState:l,updateDebugWizardState:s,resetDebugWizardState:b}=Er(),{activeDevice:i}=$t(),{device:d,isConnected:u,connect:y,disconnect:c,getAllDeviceInfo:a,error:x}=De(),{activeStep:f,firmwareVersion:v,hardwareInference:p,deviceInfo:g,pinCode:h,openDoorSuccess:C,openDoorError:T,questionAnswers:w=[],serviceUuid:k,serviceResults:I=[],batteryData:D,batteryAnalysis:P,customUuids:U=[],customResults:R=[]}=l,{openDoor:V,isOpening:re,doorStatus:F}=At(),{isReading:ge,batteryData:ye,analysis:Me,readBatteryDiagnostics:$e}=jr({batteryData:l.batteryData,analysis:l.batteryAnalysis}),[me,Ae]=$(W(!1),"isLoadingInfo"),pe=$(Bt(!1),"isFetchingRef"),[be,he]=$(W(!1),"waitingForClose"),[ve,Be]=$(W(!1),"isPreparing");J(()=>(console.log("DebugWizard: Component Mounted"),()=>console.log("DebugWizard: Component Unmounted")),[]),J(()=>{console.log(`DebugWizard: isConnected=${u}, activeDevice=${i?.id||"none"}`)},[u,i?.id]),J(()=>{i?.door_pin_code&&!h&&s({pinCode:i.door_pin_code})},[i,h,s]),J(()=>{console.log("DebugWizard: Check conditions - isConnected:",u,"firmwareVersion:",v,"isLoadingInfo:",me,"isFetchingRef:",pe.current);const z=!0;u&&!v&&!me&&!pe.current&&(async()=>{if(pe.current){console.log("DebugWizard: already fetching, skipping");return}console.log("DebugWizard: condition met, starting fetchInfo"),pe.current=!0,Ae(!0);try{console.log("DebugWizard: Starting device info fetch sequence...");const j=await a(),O=j["Firmware Revision"];console.log("DebugWizard: Raw firmware revision:",O);const H=Ut(O);console.log("DebugWizard: Hardware Inference result:",H);let X=O||"Inconnu";H.version!=="Unknown"&&(X+=` (v${H.version} - ${H.label})`),console.log("DebugWizard: Final display version string:",X),s({firmwareVersion:X,hardwareInference:H,deviceInfo:j}),console.log("DebugWizard: Called updateDebugWizardState with:",X)}catch(j){console.error("DebugWizard: Error in fetchInfo:",j)}finally{setTimeout(()=>{Ae(!1),pe.current=!1,console.log("DebugWizard: Fetch sequence finished and lock cleared.")},500)}})()},[u,v,me,s,a]);const Je=()=>{s({firmwareVersion:null})},et=()=>{s({activeStep:f+1})},tt=()=>{s({activeStep:f-1})},rt=()=>{b(),c()},nt=async()=>{if(s({openDoorError:null,openDoorSuccess:!1}),!h||h.length<4){s({openDoorError:"Veuillez entrer un code PIN valide (au moins 4 chiffres)"});return}try{await V(h),he(!0),s({openDoorSuccess:!0})}catch(z){he(!1);const ne=z instanceof Error?z.message:String(z);s({openDoorError:ne||"Échec de l'ouverture de la porte"})}},Ue=Ye(async()=>{if(!d){console.warn("DebugWizard: No device for battery check");return}console.log("DebugWizard: Executing battery diagnostics...");const z=w.find(j=>j.id==="hardware_check"),ne=z?{answer:z.answer,inference:p}:void 0;await $e(d,ne)},[d,w,p,$e]);J(()=>{be&&F==="closed"&&(console.log("DebugWizard: Door closed, initiating battery check sequence"),he(!1),Be(!0))},[F,be]),J(()=>{if(ve){const z=setTimeout(()=>{console.log("DebugWizard: Preparation delay finished, checking battery..."),Be(!1),Ue()},2e3);return()=>clearTimeout(z)}},[ve,Ue]),J(()=>{ye&&s({batteryData:ye,batteryAnalysis:Me})},[ye,Me,s]);const ot=(z,ne,j)=>{const O=[...w||[]],H=O.findIndex(it=>it.id===z),X={id:z,answer:ne,expected:j,timestamp:new Date().toISOString()};H>=0?O[H]=X:O.push(X),s({questionAnswers:O})},at=z=>{switch(z){case 0:return e(Hr,{isConnected:u,isConnecting:!1,connect:y,error:x,device:d,firmwareVersion:v,isLoadingInfo:me,onRetryFetch:Je});case 1:return e(qr,{pinCode:h,updateDebugWizardState:s,onOpenDoor:nt,isOpening:re,isConnected:u,openDoorSuccess:C,openDoorError:T,batteryData:D,waitingForClose:be,isReadingBattery:ge,isPreparing:ve,analysis:P});case 2:return e(Gr,{questionAnswers:w,onAnswerQuestion:ot});case 3:return e(Yr,{customUuids:U,customResults:R,updateDebugWizardState:s});case 4:return e(Kr,{device:d,firmwareVersion:v,hardwareInference:p,deviceInfo:g,batteryData:D,analysis:P,pinCode:h,openDoorSuccess:C,openDoorError:T,questionAnswers:w,customUuids:U,customResults:R,serviceUuid:k,serviceResults:I});default:return"Unknown step"}};return e(Nt,{maxWidth:"md",sx:{mt:4,mb:4,px:o?1:3},children:e(He,{sx:{p:o?2:4},children:[e(m,{variant:o?"h5":"h4",component:"h1",gutterBottom:!0,align:"center",children:t("wizard:title")}),o?e(S,{sx:{mb:2},children:[e(pr,{variant:"text",steps:r.length,position:"static",activeStep:f,nextButton:null,backButton:null,sx:{bgcolor:"transparent",justifyContent:"center","& .MuiMobileStepper-dot":{mx:.5}}}),e(m,{variant:"subtitle2",align:"center",color:"primary",sx:{mt:1},children:f<r.length?r[f]:t("common:finish")})]}):e(Ur,{activeStep:f,sx:{pt:3,pb:5},alternativeLabel:!0,children:r.map(z=>e(gr,{children:e(Ze,{children:z})},z))}),e(oe,{children:f===r.length?e(oe,{children:[e(m,{variant:"h5",gutterBottom:!0,children:t("wizard:finished.title")}),e(m,{variant:"subtitle1",children:t("wizard:finished.desc")}),e(S,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:e(_,{onClick:rt,children:t("common:reset")})})]}):e(oe,{children:[at(f),e(S,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:[f!==0&&e(_,{onClick:tt,sx:{mr:1},children:t("common:back")}),e(_,{variant:"contained",onClick:et,disabled:f===0&&!u,children:f===r.length-1?t("common:finish"):t("common:next")})]})]})})]})})};export{Jr as DebugWizardPage};
